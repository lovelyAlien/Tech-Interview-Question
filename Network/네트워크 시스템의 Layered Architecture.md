# 네트워크 시스템의 Layered Architecture

## 웹의 동작 방식

![img_webbasic_10](LayeredArchitecture/img_webbasic_10.png)

①② 사용자가 웹 브라우저를 통해 찾고 싶은 웹 페이지의 URL 주소를 입력함.

③ 사용자가 입력한 URL 주소 중에서 도메인 네임(domain name) 부분을 DNS 서버에서 검색함.

④ DNS 서버에서 해당 도메인 네임에 해당하는 IP 주소를 찾아 사용자가 입력한 URL 정보와 함께 전달함.

⑤⑥ 웹 페이지 URL 정보와 전달받은 IP 주소는 HTTP 프로토콜을 사용하여 HTTP 요청 메시지를 생성함.

이렇게 생성된 HTTP 요청 메시지는 TCP 프로토콜을 사용하여 인터넷을 거쳐 해당 IP 주소의 컴퓨터로 전송됨.

⑦ 이렇게 도착한 HTTP 요청 메시지는 HTTP 프로토콜을 사용하여 웹 페이지 URL 정보로 변환됨.

⑧ 웹 서버는 도착한 웹 페이지 URL 정보에 해당하는 데이터를 검색함.

⑨⑩ 검색된 웹 페이지 데이터는 또 다시 HTTP 프로토콜을 사용하여 HTTP 응답 메시지를 생성함.

이렇게 생성된 HTTP 응답 메시지는 TCP 프로토콜을 사용하여 인터넷을 거쳐 원래 컴퓨터로 전송됨.

⑪ 도착한 HTTP 응답 메시지는 HTTP 프로토콜을 사용하여 웹 페이지 데이터로 변환됨.

⑫ 변환된 웹 페이지 데이터는 웹 브라우저에 의해 출력되어 사용자가 볼 수 있게 됨.

## TCP/IP 5 Layer

`TCP/IP 5 Layer` 는 네트워크의 기본 구조를 5개의 계층으로 나눠서 표준화한 것이다.

- 1계층 - 물리 : 물리적인 연결과 전기 신호 변환/제어를 담당
- 2계층 - 데이터링크 : 네트워크 기기 간 데이터 전송 및 물리 주소를 결정
- 3계층 - 네트워크 : 다른 네트워크와 통신하기 위한 경로를 설정하고 논리 주소를 결정
- 4계층 - 전송 : 네트워크 계층에서 보내온 데이터 정렬, 오류 정정 등을 수행하고 신뢰할 수 있는 통신을 확보
- 5계층 - 응용 : 이메일, 웹 브라우저, 파일 전송 등 통신하기 위해 필요한 서비스 제공

## OSI 7 Layer

`OSI 7 Layer` 는 국제화 표준 기구인 ISO에서 개발한 컴퓨터 네트워크 프로토콜 디자인과 통신을 계층으로 나누어 설명한 개방형 시스템 상호 연결 모델

- 1계층 - 물리 : 실제 장치들을 연결하기 위해 필요한 전기적,물리적 세부 사항들을 정의하는 계층
- 2계층 - 데이터링크 : 링크의 설정과 유지 및 종료를 담당하며 노드 간의 오류 제어, 흐름 제어, 회선 제어 기능을 수행하는 계층
- 3계층 - 네트워크 : 다양한 길이의 패킷을 네트워크들을 통해 전달하고, 그 과정에서 전송 계층이 요구하는 서비스 품질을 위한 소단을 제공하는 계층
- 4계층 - 전송 : 상위 계층들이 데이터 전달의 유효성이나 효율성을 생각하지 않도록 해주면서 종단 간의 사용자들에게 신뢰성 있는 데이터를 전달하는 계층
- 5계층 - 세션 : 응용 프로그램 간의 대화를 유지하기 위한 구조를 제공하고, 이를 처리하기 위해 프로세스들의 논리적인 연결을 담당하는 계층
- 6계층 - 표현 : 애플리케이션이 다루는 정보를 통신에 알맞은 형태로 만들거나, 하위 계층에서 온 데이터를 사용자가 이해할 수 있는 형태로 만드는 역할을 담당하는 계층
- 7계층 - 응용 : 응용 프로세스와 직접 관계하여 일반적인 응용 서비스를 수행하는 역할을 담당하는 계층

## TCP, UDP, IP, PORT

### TCP

전송 제어 프로토콜(Transmission Control Protocol)

- 연결지향 - TCP 3 way handshake (가상 연결)
    1. SYN(접속 요청)
    2. SYN + ACK(요청 수락)
    3. ACK
- 데이터 전달 보증
    1. 데이터 전송
    2. 데이터 잘 받았음
- 순서 보장
    1. 패킷1,패킷2,패킷3 순서로 전송
    2. 패킷1,패킷3,패킷2 순서로 도착
    3. 패킷2부터 다시보내!
- 신뢰할 수 있는 프로토콜
- 현재는 대부분 TCP 사용

이런 것들이 가능한 이유는 `TCP 세그먼트에` 출발지 PORT, 목적지 PORT, 전송 제어, 순서, 검증 정보 등의 정보들이 담겨있기 때문이다 그렇기 때문에 `TCP` 를 신뢰할 수 있는 프로토콜이라고 부른다

### UDP

사용자 데이터그램 프로토콜(User Datagram Protocol)

- 하얀 도화지에 비유(기능이 거의 없음)
- 연결지향 - TCP 3 way handshake X
- 데이터 전달 보증 X
- 순서 보장 X
- 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠름
- 정리
    - IP와 거의 같다. + PORT + 체크섬 정도만 추가
    - 애플리케이션에서 추가 작업 필요

### IP

- 지정한 IP 주소(IP Address)에 데이터 전달
- 패킷(Packet)이라는 통신 단위로 데이터 전달

#### IP 프로토콜의 한계

- 비연결성
    - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송
- 비신뢰성
    - 중간에 패킷이 사라지면?
    - 패킷이 순서대로 안오면?
- 프로그램구분
    - 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상이라면?

`IP 프로토콜` 만으로는 문제점들을 해결할 수 없다 그래서 이런 문제점들을 해결해주는게 `TCP 프로토콜` 이다

### PORT

같은 IP 내에서 프로세스 구분

`IP가 아파트라면 PORT는 몇동 몇호이다` 라고 생각하면 편하다

- 0 ~ 65535
    - 할당 가능
- 0 ~ 1023
    - 잘 알려진 포트, 사용하지 않는 것이 좋음
- FTP
    - 20,21
- TELNET
    - 23
- HTTP
    - 80
- HTTPS
    - 443