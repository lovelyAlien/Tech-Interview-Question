# 메모리 할당과 단편화

멀티 프로세스 작업시 여러개의 프로세스를 메모리에 적재하기 위하여 메모리 영역을 분할하고 할당함.

## 용어

- 내부 단편화(Internal Fragmentation): 프로세스가 필요한 양보다 더 큰 메모리가 할당되어서 프로세스에서 사용하는 메모리 공간이 낭비되는 상황
- 외부 단편화(External Fragmentation): 할당된 메모리 사이에 작은 메모리가 생겨나게 되어, 총 메모리 공간은 충분하지만 실제로는 할당할 수 없는 상황

## 메모리 할당 방법

### 연속할당방식

분할된 메모리 공간에 프로세스를 연속되게 적재

### 고정 분할

- 분할의 수와 크기가 정해져 있다. 때문에 적재되는 프로세스는 반드시 분할된 메모리공간보다 같거나 작아야한다.
  <img src="./메모리 할당과 단편화/고정분할.png" style="margin: 5px 0px" height="200px">
- 분할된 메모리공간에는 하나의 프로세스만이 적재가 되므로 프로세스의 크기가 분할된 메모리공간보다 작을 경우 사용하지 않는 메모리 공간발생. -> 내부 단편화(internal fragmentation)

### 가변 분할

- 고정분할의 내부 단편화(internal fragmentation)현상을 해결
- 적재되는 프로그램의 크기만큼 메모리 공간을 가변적으로 분할 후 할당하는 방식
  <img src="./메모리 할당과 단편화/가변분할.png" style="margin: 5px 0px" height="400px">
- 분할 공간 사이에 크기가 너무 작아서 하용할 수 없는 빈 공간들이 산재하게 됨. -> 외부 단편화(external fragmentation)

#### 가변분할의 메모리 할당 알고리즘

- 최초 적합 방법(first-fit): 프로세스를 할당 가능한 메모리 공간을 최초로 발견될 때 할당. 모든 가용 공간을 탐색하지 않아 시간적인 측면에서 효율적.
- 최적 적합 방법(best-fit): 프로세스를 할당 가능한 메모리 중 가장 작은 공간에 할당. 사용가능한 모든 메모리공간을 탐색, 정렬해야하는 오버헤드가 발생. -> 큰 프로세스 적재 공간 확보
- 최악 적합 방법(worst-fit): 프로세스를 할당 가능한 메모리 중 가장 큰 공간에 할당. 사용가능한 모든 메모리공간을 탐색, 정렬해야하는 오버헤드가 발생. -> 외부 단편화 최소화
- 알고리즘간 효율성 비교: https://jhnyang.tistory.com/284

### 불연속할당방식

프로세스가 물리적 메모리의 여러 위치에 분산되어 적재

- paging: 프로세스의 주소 공간을 동일한 크기의 페이지 단위로 나누어 물리적 메모리의 서로 다른 위치에 페이지들을 저장하는 방식
- segmentation: 프로세스의 주소공간을 의미 단위의 세그먼트(segment)로 나누어 물리적 메모리에 올리는 방식
- paged segmentation: 두가지의 장점을 결합한 방식

## QnA

## References

> https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=wndrlf2003&logNo=220118909484
>
> https://ooeunz.tistory.com/97
>
> https://zangzangs.tistory.com/134?category=458016
>
> https://junyng.tistory.com/45
